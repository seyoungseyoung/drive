<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPT Editor - PowerPoint 스타일 프레젠테이션 에디터</title>
    
    <!-- CSS 스타일시트 -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/reset.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/charts.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/shape-editor.css') }}">
    
    <!-- 폰트 -->
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- 아이콘 라이브러리 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js 라이브러리 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- 상단 리본 메뉴 바 -->
        <div class="ribbon-menu">
            <div class="ribbon-tabs">
                <div class="ribbon-tab active" data-tab="home">홈</div>
                <div class="ribbon-tab" data-tab="insert">삽입</div>
                <div class="ribbon-tab" data-tab="design">디자인</div>
                <div class="ribbon-tab" data-tab="transitions">전환</div>
                <div class="ribbon-tab" data-tab="animations">애니메이션</div>
                <div class="ribbon-tab" data-tab="view">보기</div>
            </div>
            
            <!-- 리본 콘텐츠 영역 -->
            <div id="home-ribbon" class="ribbon-content active">
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="newSlideBtn" class="ribbon-button">
                            <i class="fas fa-plus"></i>
                            <span>새 슬라이드</span>
                        </button>
                        <button id="duplicateSlideBtn" class="ribbon-button">
                            <i class="fas fa-copy"></i>
                            <span>슬라이드 복제</span>
                        </button>
                        <button id="deleteSlideBtn" class="ribbon-button">
                            <i class="fas fa-trash"></i>
                            <span>슬라이드 삭제</span>
                        </button>
                    </div>
                    <div class="ribbon-title">슬라이드</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="addTextBtn" class="ribbon-button">
                            <i class="fas fa-font"></i>
                            <span>텍스트 상자</span>
                        </button>
                        <button id="addShapeBtn" class="ribbon-button">
                            <i class="fas fa-shapes"></i>
                            <span>도형</span>
                        </button>
                        <button id="addImageBtn" class="ribbon-button">
                            <i class="fas fa-image"></i>
                            <span>이미지</span>
                        </button>
                    </div>
                    <div class="ribbon-title">삽입</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <div class="font-style-buttons">
                            <button id="boldBtn" class="format-btn">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button id="italicBtn" class="format-btn">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button id="underlineBtn" class="format-btn">
                                <i class="fas fa-underline"></i>
                            </button>
                        </div>
                        <div class="font-align-buttons">
                            <button id="alignLeftBtn" class="format-btn">
                                <i class="fas fa-align-left"></i>
                            </button>
                            <button id="alignCenterBtn" class="format-btn">
                                <i class="fas fa-align-center"></i>
                            </button>
                            <button id="alignRightBtn" class="format-btn">
                                <i class="fas fa-align-right"></i>
                            </button>
                        </div>
                    </div>
                    <div class="ribbon-title">글꼴</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="bringToFrontBtn" class="ribbon-button">
                            <i class="fas fa-bring-forward"></i>
                            <span>앞으로 가져오기</span>
                        </button>
                        <button id="sendToBackBtn" class="ribbon-button">
                            <i class="fas fa-send-backward"></i>
                            <span>뒤로 보내기</span>
                        </button>
                    </div>
                    <div class="ribbon-title">정렬</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-controls">
                        <select id="slideLayoutSelect" class="ribbon-select">
                            <option value="blank">빈 슬라이드</option>
                            <option value="title">제목 슬라이드</option>
                            <option value="title-content">제목 및 내용</option>
                            <option value="two-column">두 개의 열</option>
                        </select>
                    </div>
                    <div class="ribbon-title">레이아웃</div>
                </div>
            </div>
            
            <div id="insert-ribbon" class="ribbon-content">
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="addTextBtn2" class="ribbon-button">
                            <i class="fas fa-font"></i>
                            <span>텍스트 상자</span>
                        </button>
                        <button id="addShapeBtn2" class="ribbon-button">
                            <i class="fas fa-shapes"></i>
                            <span>도형</span>
                        </button>
                    </div>
                    <div class="ribbon-title">텍스트</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="addImageBtn2" class="ribbon-button">
                            <i class="fas fa-image"></i>
                            <span>이미지</span>
                        </button>
                        <button id="addChartBtn" class="ribbon-button">
                            <i class="fas fa-chart-bar"></i>
                            <span>차트</span>
                        </button>
                    </div>
                    <div class="ribbon-title">일러스트레이션</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="addTableBtn" class="ribbon-button">
                            <i class="fas fa-table"></i>
                            <span>표</span>
                        </button>
                        <button id="addSmartArtBtn" class="ribbon-button">
                            <i class="fas fa-sitemap"></i>
                            <span>스마트 아트</span>
                        </button>
                    </div>
                    <div class="ribbon-title">표</div>
                </div>
            </div>
            
            <div id="design-ribbon" class="ribbon-content">
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="bgColorBtn" class="ribbon-button">
                            <i class="fas fa-fill-drip"></i>
                            <span>배경색</span>
                        </button>
                        <button id="bgImageBtn" class="ribbon-button">
                            <i class="fas fa-image"></i>
                            <span>배경 이미지</span>
                        </button>
                    </div>
                    <div class="ribbon-title">배경</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button data-theme="modern" class="theme-btn">
                            <i class="fas fa-palette"></i>
                            <span>모던</span>
                        </button>
                        <button data-theme="classic" class="theme-btn">
                            <i class="fas fa-palette"></i>
                            <span>클래식</span>
                        </button>
                        <button data-theme="colorful" class="theme-btn">
                            <i class="fas fa-palette"></i>
                            <span>컬러풀</span>
                        </button>
                    </div>
                    <div class="ribbon-title">테마</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button data-palette="blue" class="color-btn active">
                            <i class="fas fa-tint"></i>
                            <span>파란색</span>
                        </button>
                        <button data-palette="red" class="color-btn">
                            <i class="fas fa-tint"></i>
                            <span>빨간색</span>
                        </button>
                        <button data-palette="green" class="color-btn">
                            <i class="fas fa-tint"></i>
                            <span>녹색</span>
                        </button>
                    </div>
                    <div class="ribbon-title">색상</div>
                </div>
            </div>
            
            <div id="transitions-ribbon" class="ribbon-content">
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button data-transition="none" class="transition-btn active">
                            <i class="fas fa-ban"></i>
                            <span>없음</span>
                        </button>
                        <button data-transition="fade" class="transition-btn">
                            <i class="fas fa-object-ungroup"></i>
                            <span>페이드</span>
                        </button>
                        <button data-transition="slide" class="transition-btn">
                            <i class="fas fa-arrow-right"></i>
                            <span>슬라이드</span>
                        </button>
                    </div>
                    <div class="ribbon-title">전환</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-controls">
                        <div class="input-group">
                            <label>지속 시간:</label>
                            <input type="number" id="transitionDuration" min="0" max="10" step="0.1" value="1">
                            <span>초</span>
                        </div>
                    </div>
                    <div class="ribbon-title">타이밍</div>
                </div>
            </div>
            
            <div id="animations-ribbon" class="ribbon-content">
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button data-animation="none" class="animation-btn active">
                            <i class="fas fa-ban"></i>
                            <span>없음</span>
                        </button>
                        <button data-animation="fade-in" class="animation-btn">
                            <i class="fas fa-eye"></i>
                            <span>페이드</span>
                        </button>
                        <button data-animation="slide-in" class="animation-btn">
                            <i class="fas fa-long-arrow-alt-right"></i>
                            <span>슬라이드</span>
                        </button>
                    </div>
                    <div class="ribbon-title">애니메이션</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-controls">
                        <div class="input-group">
                            <label>지속 시간:</label>
                            <input type="number" id="animationDuration" min="0" max="10" step="0.1" value="1">
                            <span>초</span>
                        </div>
                        <div class="input-group">
                            <label>지연 시간:</label>
                            <input type="number" id="animationDelay" min="0" max="10" step="0.1" value="0">
                            <span>초</span>
                        </div>
                    </div>
                    <div class="ribbon-title">타이밍</div>
                </div>
            </div>
            
            <div id="view-ribbon" class="ribbon-content">
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="slideShowBtn" class="ribbon-button">
                            <i class="fas fa-play"></i>
                            <span>슬라이드 쇼</span>
                        </button>
                        <button id="presenterViewBtn" class="ribbon-button">
                            <i class="fas fa-user"></i>
                            <span>발표자 모드</span>
                        </button>
                        <button id="exportBtn" class="ribbon-button">
                            <i class="fas fa-file-export"></i>
                            <span>내보내기</span>
                        </button>
                    </div>
                    <div class="ribbon-title">프레젠테이션</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-controls">
                        <select id="zoomSelect" class="ribbon-select">
                            <option value="0.5">50%</option>
                            <option value="0.75">75%</option>
                            <option value="1" selected>100%</option>
                            <option value="1.25">125%</option>
                            <option value="1.5">150%</option>
                            <option value="2">200%</option>
                        </select>
                    </div>
                    <div class="ribbon-title">확대/축소</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="gridBtn" class="ribbon-button">
                            <i class="fas fa-th"></i>
                            <span>눈금자</span>
                        </button>
                        <button id="rulerBtn" class="ribbon-button">
                            <i class="fas fa-ruler-combined"></i>
                            <span>안내선</span>
                        </button>
                    </div>
                    <div class="ribbon-title">표시</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="toggleAIBtn" class="ribbon-button">
                            <i class="fas fa-robot"></i>
                            <span>AI 도우미</span>
                        </button>
                    </div>
                    <div class="ribbon-title">확장</div>
                </div>
            </div>
        </div>
        
        <!-- 메인 작업 영역 -->
        <div class="workspace">
            <!-- 왼쪽 슬라이드 탐색기 -->
            <div class="slide-explorer">
                <div class="slides-header">
                    <h3>슬라이드</h3>
                    <div class="slide-controls">
                        <button id="addSlideBtn" title="슬라이드 추가">
                            <i class="fas fa-plus"></i>
                        </button>
                        <button id="duplicateSlideBtn2" title="슬라이드 복제">
                            <i class="fas fa-copy"></i>
                        </button>
                        <button id="deleteSlideBtn2" title="슬라이드 삭제">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <!-- 슬라이드 목록 -->
                <div id="slideList" class="slide-list"></div>
            </div>
            
            <!-- 중앙 편집 영역 -->
            <div class="editor-area">
                <div class="editor-toolbar">
                    <div class="toolbar-left">
                        <button id="undoBtn" title="실행 취소">
                            <i class="fas fa-undo"></i>
                        </button>
                        <button id="redoBtn" title="다시 실행">
                            <i class="fas fa-redo"></i>
                        </button>
                        <span class="toolbar-separator"></span>
                        <select id="slideLayoutSelect">
                            <option value="blank">빈 슬라이드</option>
                            <option value="title">제목 슬라이드</option>
                            <option value="title-content">제목 및 내용</option>
                            <option value="two-column">두 열 레이아웃</option>
                        </select>
                    </div>
                    <div class="toolbar-right">
                        <button id="exportBtn" title="내보내기">
                            <i class="fas fa-download"></i>
                            <span>내보내기</span>
                        </button>
                    </div>
                </div>
                
                <!-- 슬라이드 편집 영역 -->
                <div class="slide-editor independent-scroll">
                    <div id="currentSlide" class="slide-canvas">
                        <!-- Slide elements will be rendered here -->
                    </div>
                </div>
                
                <!-- 발표자 노트 패널 추가 -->
                <div class="presenter-notes-panel">
                    <div class="presenter-notes-header">
                        <h3>발표자 노트</h3>
                        <button id="toggleNotesBtn" class="toggle-btn">
                            <i class="fas fa-chevron-up"></i>
                        </button>
                    </div>
                    <div class="presenter-notes-content">
                        <textarea id="slideNotes" placeholder="이 슬라이드에 대한 발표자 노트를 작성하세요"></textarea>
                    </div>
                </div>
            </div>
            
            <!-- 오른쪽 속성 패널 -->
            <div class="properties-panel">
                <div class="panel-header">
                    <h3>속성</h3>
                    <button id="closePropertiesBtn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="panel-tabs">
                    <button class="panel-tab active" data-panel="style">스타일</button>
                    <button class="panel-tab" data-panel="text">텍스트</button>
                    <button class="panel-tab" data-panel="arrange">정렬</button>
                    <button class="panel-tab" data-panel="animation">애니메이션</button>
                </div>
                
                <!-- 스타일 패널 -->
                <div class="panel-content active" id="style-panel">
                    <div class="panel-section">
                        <h4>색상 및 채우기</h4>
                        <div class="color-picker-group">
                            <label>배경색</label>
                            <input type="color" id="elementBgColor">
                        </div>
                        <div class="color-picker-group">
                            <label>테두리 색상</label>
                            <input type="color" id="elementBorderColor">
                        </div>
                        <div class="slider-group">
                            <label>투명도 <span id="opacityValue">100%</span></label>
                            <input type="range" id="elementOpacity" min="0" max="100" value="100">
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>테두리</h4>
                        <div class="input-group">
                            <label>두께</label>
                            <input type="number" id="borderWidth" min="0" max="20" value="1">
                        </div>
                        <div class="select-group">
                            <label>스타일</label>
                            <select id="borderStyle">
                                <option value="solid">실선</option>
                                <option value="dashed">파선</option>
                                <option value="dotted">점선</option>
                                <option value="double">이중선</option>
                                <option value="none">없음</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>효과</h4>
                        <div class="select-group">
                            <label>그림자</label>
                            <select id="shadowStyle">
                                <option value="none">없음</option>
                                <option value="light">약함</option>
                                <option value="medium">중간</option>
                                <option value="strong">강함</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- 텍스트 패널 -->
                <div class="panel-content" id="text-panel">
                    <div class="panel-section">
                        <h4>글꼴</h4>
                        <div class="select-group">
                            <label>글꼴</label>
                            <select id="textFontFamily">
                                <option value="Pretendard">Pretendard</option>
                                <option value="Arial">Arial</option>
                                <option value="Helvetica">Helvetica</option>
                                <option value="Times New Roman">Times New Roman</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>크기</label>
                            <input type="number" id="textFontSize" min="8" max="96" value="16">
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>스타일</h4>
                        <div class="button-group">
                            <button id="textBoldBtn" class="format-btn">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button id="textItalicBtn" class="format-btn">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button id="textUnderlineBtn" class="format-btn">
                                <i class="fas fa-underline"></i>
                            </button>
                        </div>
                        <div class="color-picker-group">
                            <label>텍스트 색상</label>
                            <input type="color" id="textColor">
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>정렬</h4>
                        <div class="button-group">
                            <button id="textAlignLeftBtn" class="format-btn">
                                <i class="fas fa-align-left"></i>
                            </button>
                            <button id="textAlignCenterBtn" class="format-btn">
                                <i class="fas fa-align-center"></i>
                            </button>
                            <button id="textAlignRightBtn" class="format-btn">
                                <i class="fas fa-align-right"></i>
                            </button>
                            <button id="textAlignJustifyBtn" class="format-btn">
                                <i class="fas fa-align-justify"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 정렬 패널 -->
                <div class="panel-content" id="arrange-panel">
                    <div class="panel-section">
                        <h4>위치</h4>
                        <div class="position-controls">
                            <div class="input-group">
                                <label>X</label>
                                <input type="number" id="elementX" step="1">
                            </div>
                            <div class="input-group">
                                <label>Y</label>
                                <input type="number" id="elementY" step="1">
                            </div>
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>크기</h4>
                        <div class="size-controls">
                            <div class="input-group">
                                <label>너비</label>
                                <input type="number" id="elementWidth" min="5" step="1">
                            </div>
                            <div class="input-group">
                                <label>높이</label>
                                <input type="number" id="elementHeight" min="5" step="1">
                            </div>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="lockAspectRatio">
                            <label for="lockAspectRatio">비율 고정</label>
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>회전</h4>
                        <div class="slider-group">
                            <label>각도 <span id="rotationValue">0°</span></label>
                            <input type="range" id="elementRotation" min="0" max="359" value="0">
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>기울이기</h4>
                        <div class="slider-group">
                            <label>X축 <span id="skewXValue">0°</span></label>
                            <input type="range" id="elementSkewX" min="-45" max="45" value="0">
                        </div>
                        <div class="slider-group">
                            <label>Y축 <span id="skewYValue">0°</span></label>
                            <input type="range" id="elementSkewY" min="-45" max="45" value="0">
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>순서</h4>
                        <div class="button-group">
                            <button id="bringToFrontBtn">맨 앞으로</button>
                            <button id="sendToBackBtn">맨 뒤로</button>
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>AI 분석</h4>
                        <div class="button-group">
                            <button id="analyzeElementBtn" class="btn-primary">
                                <i class="fas fa-magic"></i> 요소 분석 및 개선
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 애니메이션 패널 -->
                <div class="panel-content" id="animation-panel">
                    <div class="panel-section">
                        <h4>애니메이션</h4>
                        <div class="select-group">
                            <label>유형</label>
                            <select id="animationType">
                                <option value="none">없음</option>
                                <option value="fade">페이드</option>
                                <option value="slide">슬라이드</option>
                                <option value="zoom">확대/축소</option>
                                <option value="flip">뒤집기</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>시간</h4>
                        <div class="input-group">
                            <label>지속 시간 (초)</label>
                            <input type="number" id="animationDuration" min="0.1" max="10" step="0.1" value="1">
                        </div>
                        <div class="input-group">
                            <label>지연 시간 (초)</label>
                            <input type="number" id="animationDelay" min="0" max="10" step="0.1" value="0">
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>미리보기</h4>
                        <button id="previewAnimationBtn">재생</button>
                    </div>
                </div>
                
                <!-- AI 확장 패널 -->
                <div class="panel-content" id="ai-panel" style="display: none;">
                    <div class="panel-section">
                        <h4>AI 도구</h4>
                        <div class="button-group">
                            <button id="analyzeBtn">
                                <i class="fas fa-magic"></i>
                                <span>콘텐츠 분석</span>
                            </button>
                            <button id="generateImageBtn">
                                <i class="fas fa-image"></i>
                                <span>이미지 생성</span>
                            </button>
                            <button id="improveDesignBtn">
                                <i class="fas fa-paint-brush"></i>
                                <span>디자인 개선</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>AI 제안</h4>
                        <div id="aiSuggestions" class="ai-suggestions"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 상태 표시줄 -->
        <div class="status-bar">
            <div class="status-left">
                <span id="slideInfo">슬라이드 1/1</span>
            </div>
            <div class="status-right">
                <span id="zoomInfo">100%</span>
            </div>
        </div>

        <!-- DeepSeek AI 확장 패널 -->
        <div class="deep-seek-panel collapsed">
            <div class="deep-seek-header">
                <h3><i class="fas fa-robot"></i> DeepSeek AI 도우미</h3>
                <button id="toggleDeepSeekPanelBtn" class="toggle-btn">
                    <i class="fas fa-chevron-up"></i>
                </button>
            </div>
            <div class="deep-seek-content">
                <div class="ai-prompt-container">
                    <textarea class="ai-prompt" id="aiPrompt" placeholder="AI에게 질문하거나 도움을 요청하세요. 예: '이 슬라이드에 맞는 제목을 추천해줘'"></textarea>
                    <div class="ai-actions">
                        <button class="ai-btn primary" id="aiSubmitBtn">
                            <i class="fas fa-paper-plane"></i> 전송
                        </button>
                        <button class="ai-btn" id="aiMoreOptionsBtn">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                    </div>
                </div>
                
                <div class="ai-features">
                    <div class="ai-feature" data-feature="design">
                        <div class="ai-feature-icon"><i class="fas fa-paint-brush"></i></div>
                        <div class="ai-feature-title">디자인 개선</div>
                        <div class="ai-feature-desc">슬라이드 디자인 자동 개선</div>
                    </div>
                    <div class="ai-feature" data-feature="content">
                        <div class="ai-feature-icon"><i class="fas fa-file-alt"></i></div>
                        <div class="ai-feature-title">내용 생성</div>
                        <div class="ai-feature-desc">텍스트와 내용 자동 생성</div>
                    </div>
                    <div class="ai-feature" data-feature="image">
                        <div class="ai-feature-icon"><i class="fas fa-image"></i></div>
                        <div class="ai-feature-title">이미지 생성</div>
                        <div class="ai-feature-desc">슬라이드에 맞는 이미지 생성</div>
                    </div>
                    <div class="ai-feature" data-feature="layout">
                        <div class="ai-feature-icon"><i class="fas fa-th-large"></i></div>
                        <div class="ai-feature-title">레이아웃 추천</div>
                        <div class="ai-feature-desc">최적의 레이아웃 제안</div>
                    </div>
                    <div class="ai-feature" data-feature="summary">
                        <div class="ai-feature-icon"><i class="fas fa-list"></i></div>
                        <div class="ai-feature-title">내용 요약</div>
                        <div class="ai-feature-desc">텍스트를 핵심 포인트로 요약</div>
                    </div>
                    <div class="ai-feature" data-feature="translate">
                        <div class="ai-feature-icon"><i class="fas fa-language"></i></div>
                        <div class="ai-feature-title">번역</div>
                        <div class="ai-feature-desc">다양한 언어로 콘텐츠 번역</div>
                    </div>
                </div>
                
                <div class="ai-results">
                    <!-- AI 결과가 여기에 추가됩니다 -->
                    <div class="ai-result-item">
                        <div class="ai-result-title">
                            환영합니다
                            <div class="ai-result-actions">
                                <button class="ai-result-action"><i class="fas fa-copy"></i></button>
                            </div>
                        </div>
                        <div class="ai-result-content">
                            DeepSeek AI 도우미를 통해 프레젠테이션을 빠르고 효과적으로 만들 수 있습니다. 어떻게 도와드릴까요?
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 모달 대화상자 -->
    <!-- 도형 선택 모달 -->
    <div id="shapeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>도형 선택</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="shape-category">기본 도형</div>
                <div class="shape-grid">
                    <div class="shape-item" data-shape="rectangle">
                        <div class="shape-preview rectangle"></div>
                        <span>직사각형</span>
                    </div>
                    <div class="shape-item" data-shape="circle">
                        <div class="shape-preview circle"></div>
                        <span>원</span>
                    </div>
                    <div class="shape-item" data-shape="triangle">
                        <div class="shape-preview triangle"></div>
                        <span>삼각형</span>
                    </div>
                    <div class="shape-item" data-shape="pentagon">
                        <div class="shape-preview pentagon"></div>
                        <span>오각형</span>
                    </div>
                    <div class="shape-item" data-shape="hexagon">
                        <div class="shape-preview hexagon"></div>
                        <span>육각형</span>
                    </div>
                    <div class="shape-item" data-shape="star">
                        <div class="shape-preview star"></div>
                        <span>별</span>
                    </div>
                </div>
                
                <div class="shape-category">화살표 및 선</div>
                <div class="shape-grid">
                    <div class="shape-item" data-shape="arrow">
                        <div class="shape-preview arrow"></div>
                        <span>화살표</span>
                    </div>
                    <div class="shape-item" data-shape="arrow-left">
                        <div class="shape-preview arrow-left"></div>
                        <span>왼쪽 화살표</span>
                    </div>
                    <div class="shape-item" data-shape="double-arrow">
                        <div class="shape-preview double-arrow"></div>
                        <span>양방향 화살표</span>
                    </div>
                    <div class="shape-item" data-shape="line">
                        <div class="shape-preview line"></div>
                        <span>선</span>
                    </div>
                    <div class="shape-item" data-shape="dashed-line">
                        <div class="shape-preview dashed-line"></div>
                        <span>점선</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 이미지 업로드 모달 -->
    <div id="imageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>이미지 추가</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="upload-area">
                    <p>이미지 파일을 드래그하거나 클릭하여 업로드하세요</p>
                    <input type="file" id="imageUploadInput" accept="image/*">
                    <button id="uploadImageBtn">파일 선택</button>
                </div>
                <div class="image-preview-container">
                    <img id="imagePreview" src="" alt="">
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelImageBtn" class="btn-secondary">취소</button>
                <button id="addImageToSlideBtn" class="btn-primary">슬라이드에 추가</button>
            </div>
        </div>
    </div>
    
    <!-- 내보내기 모달 -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>프레젠테이션 내보내기</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="export-options">
                    <div class="option-group">
                        <label>형식</label>
                        <select id="exportFormat">
                            <option value="pptx">PowerPoint (PPTX)</option>
                            <option value="pdf">PDF</option>
                            <option value="png">이미지 (PNG)</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <label>품질</label>
                        <select id="exportQuality">
                            <option value="high">높음</option>
                            <option value="medium">중간</option>
                            <option value="low">낮음</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelExportBtn" class="btn-secondary">취소</button>
                <button id="confirmExportBtn" class="btn-primary">내보내기</button>
            </div>
        </div>
    </div>
    
    <!-- 발표자 모드 모달 추가 -->
    <div id="presenterModal" class="modal">
        <div class="presenter-modal-content">
            <div class="presenter-header">
                <h3>발표자 모드</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="presenter-body">
                <div class="presenter-main-slide">
                    <div id="presenterCurrentSlide" class="presenter-slide"></div>
                    <div class="presenter-controls">
                        <button id="prevSlideBtn"><i class="fas fa-arrow-left"></i></button>
                        <span id="slideCounter">1/10</span>
                        <button id="nextSlideBtn"><i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
                <div class="presenter-sidebar">
                    <div class="presenter-next-slide">
                        <h4>다음 슬라이드</h4>
                        <div id="presenterNextSlide" class="presenter-preview"></div>
                    </div>
                    <div class="presenter-notes">
                        <h4>발표자 노트</h4>
                        <div id="presenterNotes" class="notes-content"></div>
                    </div>
                    <div class="presenter-timer">
                        <h4>발표 시간</h4>
                        <div class="timer-display">
                            <span id="presenterTimer">00:00:00</span>
                            <button id="startTimerBtn" class="timer-btn">
                                <i class="fas fa-play"></i>
                            </button>
                            <button id="resetTimerBtn" class="timer-btn">
                                <i class="fas fa-redo"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 디버그 정보 -->
    <div id="debug-info" style="display: none;"></div>
    <button id="show-debug" style="display: none;">Debug</button>
    
    <!-- 스크립트 -->
    <!-- Chart.js 필수 스크립트 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- 모듈 스크립트 -->
    <script type="module">
        // DOM이 로드된 후 앱 초기화
        document.addEventListener('DOMContentLoaded', () => {
            import("{{ url_for('static', filename='js/index.js') }}")
                .then(module => {
                    // 앱 초기화
                    module.initApp();
                    console.log('앱이 성공적으로 초기화되었습니다.');
                })
                .catch(err => {
                    console.error('모듈 로드 오류:', err);
                });
        });
    </script>

    <!-- DeepSeek AI 모달 -->
    <div id="deepSeekModal" class="modal deep-seek-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>DeepSeek AI 도우미</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="deep-seek-tabs">
                    <div class="deep-seek-tab active" data-tab="design">디자인 개선</div>
                    <div class="deep-seek-tab" data-tab="content">내용 생성</div>
                    <div class="deep-seek-tab" data-tab="image">이미지 생성</div>
                </div>
                
                <div class="deep-seek-tab-content active" id="design-tab">
                    <div class="deep-seek-options">
                        <div class="deep-seek-option selected">
                            <div class="deep-seek-option-icon"><i class="fas fa-magic"></i></div>
                            <div class="deep-seek-option-title">자동 개선</div>
                        </div>
                        <div class="deep-seek-option">
                            <div class="deep-seek-option-icon"><i class="fas fa-palette"></i></div>
                            <div class="deep-seek-option-title">색상 조정</div>
                        </div>
                        <div class="deep-seek-option">
                            <div class="deep-seek-option-icon"><i class="fas fa-th"></i></div>
                            <div class="deep-seek-option-title">레이아웃</div>
                        </div>
                        <div class="deep-seek-option">
                            <div class="deep-seek-option-icon"><i class="fas fa-font"></i></div>
                            <div class="deep-seek-option-title">타이포그래피</div>
                        </div>
                    </div>
                    
                    <div class="deep-seek-prompt-container">
                        <label for="designPrompt">상세 요청 사항:</label>
                        <textarea id="designPrompt" class="deep-seek-prompt" placeholder="원하는 디자인 스타일이나 요청사항을 입력하세요"></textarea>
                    </div>
                </div>
                
                <div class="deep-seek-tab-content" id="content-tab">
                    <div class="deep-seek-options">
                        <div class="deep-seek-option selected">
                            <div class="deep-seek-option-icon"><i class="fas fa-heading"></i></div>
                            <div class="deep-seek-option-title">제목 생성</div>
                        </div>
                        <div class="deep-seek-option">
                            <div class="deep-seek-option-icon"><i class="fas fa-list-ul"></i></div>
                            <div class="deep-seek-option-title">글머리 기호</div>
                        </div>
                        <div class="deep-seek-option">
                            <div class="deep-seek-option-icon"><i class="fas fa-paragraph"></i></div>
                            <div class="deep-seek-option-title">단락 생성</div>
                        </div>
                        <div class="deep-seek-option">
                            <div class="deep-seek-option-icon"><i class="fas fa-quote-right"></i></div>
                            <div class="deep-seek-option-title">인용문</div>
                        </div>
                    </div>
                    
                    <div class="deep-seek-prompt-container">
                        <label for="contentPrompt">주제 또는 요청 사항:</label>
                        <textarea id="contentPrompt" class="deep-seek-prompt" placeholder="어떤 내용을 생성할지 설명해주세요"></textarea>
                    </div>
                </div>
                
                <div class="deep-seek-tab-content" id="image-tab">
                    <div class="deep-seek-options">
                        <div class="deep-seek-option selected">
                            <div class="deep-seek-option-icon"><i class="fas fa-image"></i></div>
                            <div class="deep-seek-option-title">사진</div>
                        </div>
                        <div class="deep-seek-option">
                            <div class="deep-seek-option-icon"><i class="fas fa-vector-square"></i></div>
                            <div class="deep-seek-option-title">아이콘</div>
                        </div>
                        <div class="deep-seek-option">
                            <div class="deep-seek-option-icon"><i class="fas fa-chart-pie"></i></div>
                            <div class="deep-seek-option-title">차트</div>
                        </div>
                        <div class="deep-seek-option">
                            <div class="deep-seek-option-icon"><i class="fas fa-sitemap"></i></div>
                            <div class="deep-seek-option-title">다이어그램</div>
                        </div>
                    </div>
                    
                    <div class="deep-seek-prompt-container">
                        <label for="imagePrompt">이미지 설명:</label>
                        <textarea id="imagePrompt" class="deep-seek-prompt" placeholder="생성할 이미지에 대해 상세히 설명해주세요"></textarea>
                    </div>
                </div>
                
                <div class="deep-seek-progress" style="display: none;">
                    <div class="deep-seek-spinner"></div>
                    <div class="deep-seek-progress-text">AI가 작업을 처리하고 있습니다...</div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelDeepSeekBtn" class="btn-secondary">취소</button>
                <button id="confirmDeepSeekBtn" class="btn-primary">생성하기</button>
            </div>
        </div>
    </div>
</body>
</html>