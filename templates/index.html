<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPT Editor - PowerPoint-like Presentation Editor</title>
    
    <!-- CSS stylesheets -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/reset.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/charts.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/shape-editor.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icon library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Top ribbon menu bar -->
        <div class="ribbon-menu">
            <div class="ribbon-tabs">
                <div class="ribbon-tab active" data-tab="file">File</div>
                <div class="ribbon-tab" data-tab="home">Home</div>
                <div class="ribbon-tab" data-tab="insert">Insert</div>
                <div class="ribbon-tab" data-tab="design">Design</div>
                <div class="ribbon-tab" data-tab="transitions">Transitions</div>
                <div class="ribbon-tab" data-tab="animations">Animations</div>
                <div class="ribbon-tab" data-tab="view">View</div>
                <div class="ribbon-tab" data-tab="ai-assist">AI Assistant</div>
            </div>
            
            <!-- Ribbon content area -->
            <div id="file-ribbon" class="ribbon-content active">
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="newPresentationBtn" class="ribbon-button">
                            <i class="fas fa-file"></i>
                            <span>New</span>
                        </button>
                        <button id="openPresentationBtn" class="ribbon-button">
                            <i class="fas fa-folder-open"></i>
                            <span>Open</span>
                        </button>
                        <button id="savePresentationBtn" class="ribbon-button">
                            <i class="fas fa-save"></i>
                            <span>Save</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Presentation</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="exportPptxBtn" class="ribbon-button">
                            <i class="fas fa-file-powerpoint"></i>
                            <span>Export as PPTX</span>
                        </button>
                        <button id="exportPdfBtn" class="ribbon-button">
                            <i class="fas fa-file-pdf"></i>
                            <span>Export as PDF</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Export</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="printBtn" class="ribbon-button">
                            <i class="fas fa-print"></i>
                            <span>Print</span>
                        </button>
                        <button id="shareBtn" class="ribbon-button">
                            <i class="fas fa-share-alt"></i>
                            <span>Share</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Output</div>
                </div>
            </div>
            
            <div id="home-ribbon" class="ribbon-content">
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="newSlideBtn" class="ribbon-button">
                            <i class="fas fa-plus"></i>
                            <span>New Slide</span>
                        </button>
                        <button id="duplicateSlideBtn" class="ribbon-button">
                            <i class="fas fa-copy"></i>
                            <span>Duplicate</span>
                        </button>
                        <button id="deleteSlideBtn" class="ribbon-button">
                            <i class="fas fa-trash"></i>
                            <span>Delete</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Slides</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <div class="font-controls">
                            <select id="fontFamilySelect" class="ribbon-select">
                                <option value="Pretendard">Pretendard</option>
                                <option value="Arial">Arial</option>
                                <option value="Helvetica">Helvetica</option>
                                <option value="Times New Roman">Times New Roman</option>
                                <option value="Georgia">Georgia</option>
                            </select>
                            <select id="fontSizeSelect" class="ribbon-select">
                                <option value="8">8</option>
                                <option value="10">10</option>
                                <option value="12">12</option>
                                <option value="14">14</option>
                                <option value="18">18</option>
                                <option value="24">24</option>
                                <option value="36">36</option>
                                <option value="48">48</option>
                                <option value="60">60</option>
                                <option value="72">72</option>
                            </select>
                        </div>
                        <div class="font-style-buttons">
                            <button id="boldBtn" class="format-btn">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button id="italicBtn" class="format-btn">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button id="underlineBtn" class="format-btn">
                                <i class="fas fa-underline"></i>
                            </button>
                        </div>
                    </div>
                    <div class="ribbon-title">Font</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <div class="font-align-buttons">
                            <button id="alignLeftBtn" class="format-btn">
                                <i class="fas fa-align-left"></i>
                            </button>
                            <button id="alignCenterBtn" class="format-btn">
                                <i class="fas fa-align-center"></i>
                            </button>
                            <button id="alignRightBtn" class="format-btn">
                                <i class="fas fa-align-right"></i>
                            </button>
                            <button id="alignJustifyBtn" class="format-btn">
                                <i class="fas fa-align-justify"></i>
                            </button>
                        </div>
                        <div class="line-spacing-buttons">
                            <button id="decreaseLineSpacingBtn" class="format-btn">
                                <i class="fas fa-arrow-down"></i>
                            </button>
                            <button id="increaseLineSpacingBtn" class="format-btn">
                                <i class="fas fa-arrow-up"></i>
                            </button>
                        </div>
                    </div>
                    <div class="ribbon-title">Paragraph</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="color-controls">
                        <button id="textColorBtn" class="color-btn">
                            <i class="fas fa-font" style="color: #333;"></i>
                            <span class="color-indicator"></span>
                        </button>
                        <button id="fillColorBtn" class="color-btn">
                            <i class="fas fa-fill-drip"></i>
                            <span class="color-indicator"></span>
                        </button>
                    </div>
                    <div class="ribbon-title">Colors</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="bringToFrontBtn" class="ribbon-button">
                            <i class="fas fa-bring-forward"></i>
                            <span>Bring Forward</span>
                        </button>
                        <button id="sendToBackBtn" class="ribbon-button">
                            <i class="fas fa-send-backward"></i>
                            <span>Send Backward</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Arrange</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-controls">
                        <select id="slideLayoutSelect" class="ribbon-select">
                            <option value="blank">Blank</option>
                            <option value="title">Title Slide</option>
                            <option value="title-content">Title and Content</option>
                            <option value="two-column">Two Content</option>
                            <option value="title-only">Title Only</option>
                            <option value="comparison">Comparison</option>
                            <option value="content-caption">Content with Caption</option>
                            <option value="section-header">Section Header</option>
                        </select>
                    </div>
                    <div class="ribbon-title">Layout</div>
                </div>
            </div>
            
            <div id="insert-ribbon" class="ribbon-content">
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="addTextBtn" class="ribbon-button">
                            <i class="fas fa-font"></i>
                            <span>Text Box</span>
                        </button>
                        <button id="addWordArtBtn" class="ribbon-button">
                            <i class="fas fa-signature"></i>
                            <span>WordArt</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Text</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="addTableBtn" class="ribbon-button">
                            <i class="fas fa-table"></i>
                            <span>Table</span>
                        </button>
                        <button id="addSmartArtBtn" class="ribbon-button">
                            <i class="fas fa-sitemap"></i>
                            <span>SmartArt</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Tables</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="addImageBtn" class="ribbon-button">
                            <i class="fas fa-image"></i>
                            <span>Images</span>
                        </button>
                        <button id="addChartBtn" class="ribbon-button">
                            <i class="fas fa-chart-bar"></i>
                            <span>Chart</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Illustrations</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="addShapeBtn" class="ribbon-button">
                            <i class="fas fa-shapes"></i>
                            <span>Shapes</span>
                        </button>
                        <button id="addIconBtn" class="ribbon-button">
                            <i class="fas fa-icons"></i>
                            <span>Icons</span>
                        </button>
                        <button id="add3DModelBtn" class="ribbon-button">
                            <i class="fas fa-cube"></i>
                            <span>3D Models</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Graphics</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="addVideoBtn" class="ribbon-button">
                            <i class="fas fa-video"></i>
                            <span>Video</span>
                        </button>
                        <button id="addAudioBtn" class="ribbon-button">
                            <i class="fas fa-volume-up"></i>
                            <span>Audio</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Media</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="addCommentBtn" class="ribbon-button">
                            <i class="fas fa-comment"></i>
                            <span>Comment</span>
                        </button>
                        <button id="addFooterBtn" class="ribbon-button">
                            <i class="fas fa-grip-lines"></i>
                            <span>Header & Footer</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Notes</div>
                </div>
            </div>
            
            <div id="design-ribbon" class="ribbon-content">
                <div class="ribbon-group">
                    <div class="theme-gallery">
                        <button data-theme="modern" class="theme-btn">
                            <div class="theme-preview theme-modern"></div>
                            <span>Modern</span>
                        </button>
                        <button data-theme="classic" class="theme-btn">
                            <div class="theme-preview theme-classic"></div>
                            <span>Classic</span>
                        </button>
                        <button data-theme="colorful" class="theme-btn">
                            <div class="theme-preview theme-colorful"></div>
                            <span>Colorful</span>
                        </button>
                        <button data-theme="minimal" class="theme-btn">
                            <div class="theme-preview theme-minimal"></div>
                            <span>Minimal</span>
                        </button>
                        <button data-theme="corporate" class="theme-btn">
                            <div class="theme-preview theme-corporate"></div>
                            <span>Corporate</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Themes</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="bgColorBtn" class="ribbon-button">
                            <i class="fas fa-fill-drip"></i>
                            <span>Background Color</span>
                        </button>
                        <button id="bgImageBtn" class="ribbon-button">
                            <i class="fas fa-image"></i>
                            <span>Background Image</span>
                        </button>
                        <button id="bgStylesBtn" class="ribbon-button">
                            <i class="fas fa-brush"></i>
                            <span>Format Background</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Background</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-controls">
                        <div class="color-scheme-gallery">
                            <button data-palette="blue" class="color-btn active">
                                <div class="color-preview color-blue"></div>
                                <span>Blue</span>
                            </button>
                            <button data-palette="red" class="color-btn">
                                <div class="color-preview color-red"></div>
                                <span>Red</span>
                            </button>
                            <button data-palette="green" class="color-btn">
                                <div class="color-preview color-green"></div>
                                <span>Green</span>
                            </button>
                            <button data-palette="purple" class="color-btn">
                                <div class="color-preview color-purple"></div>
                                <span>Purple</span>
                            </button>
                            <button data-palette="orange" class="color-btn">
                                <div class="color-preview color-orange"></div>
                                <span>Orange</span>
                            </button>
                        </div>
                    </div>
                    <div class="ribbon-title">Colors</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-controls">
                        <select id="fontThemeSelect" class="ribbon-select">
                            <option value="default">Default</option>
                            <option value="modern">Modern</option>
                            <option value="classic">Classic</option>
                            <option value="elegant">Elegant</option>
                            <option value="display">Display</option>
                        </select>
                    </div>
                    <div class="ribbon-title">Fonts</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="slideSizeBtn" class="ribbon-button">
                            <i class="fas fa-crop"></i>
                            <span>Slide Size</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Customize</div>
                </div>
            </div>
            
            <div id="transitions-ribbon" class="ribbon-content">
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button data-transition="none" class="transition-btn active">
                            <i class="fas fa-ban"></i>
                            <span>없음</span>
                        </button>
                        <button data-transition="fade" class="transition-btn">
                            <i class="fas fa-object-ungroup"></i>
                            <span>페이드</span>
                        </button>
                        <button data-transition="slide" class="transition-btn">
                            <i class="fas fa-arrow-right"></i>
                            <span>슬라이드</span>
                        </button>
                    </div>
                    <div class="ribbon-title">전환</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-controls">
                        <div class="input-group">
                            <label>지속 시간:</label>
                            <input type="number" id="transitionDuration" min="0" max="10" step="0.1" value="1">
                            <span>초</span>
                        </div>
                    </div>
                    <div class="ribbon-title">타이밍</div>
                </div>
            </div>
            
            <div id="animations-ribbon" class="ribbon-content">
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button data-animation="none" class="animation-btn active">
                            <i class="fas fa-ban"></i>
                            <span>없음</span>
                        </button>
                        <button data-animation="fade-in" class="animation-btn">
                            <i class="fas fa-eye"></i>
                            <span>페이드</span>
                        </button>
                        <button data-animation="slide-in" class="animation-btn">
                            <i class="fas fa-long-arrow-alt-right"></i>
                            <span>슬라이드</span>
                        </button>
                    </div>
                    <div class="ribbon-title">애니메이션</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-controls">
                        <div class="input-group">
                            <label>지속 시간:</label>
                            <input type="number" id="animationDuration" min="0" max="10" step="0.1" value="1">
                            <span>초</span>
                        </div>
                        <div class="input-group">
                            <label>지연 시간:</label>
                            <input type="number" id="animationDelay" min="0" max="10" step="0.1" value="0">
                            <span>초</span>
                        </div>
                    </div>
                    <div class="ribbon-title">타이밍</div>
                </div>
            </div>
            
            <div id="view-ribbon" class="ribbon-content">
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="slideShowBtn" class="ribbon-button">
                            <i class="fas fa-play"></i>
                            <span>Slide Show</span>
                        </button>
                        <button id="presenterViewBtn" class="ribbon-button">
                            <i class="fas fa-user"></i>
                            <span>Presenter View</span>
                        </button>
                        <button id="exportBtn" class="ribbon-button">
                            <i class="fas fa-file-export"></i>
                            <span>Export</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Presentation</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-controls">
                        <select id="zoomSelect" class="ribbon-select">
                            <option value="0.5">50%</option>
                            <option value="0.75">75%</option>
                            <option value="1" selected>100%</option>
                            <option value="1.25">125%</option>
                            <option value="1.5">150%</option>
                            <option value="2">200%</option>
                        </select>
                    </div>
                    <div class="ribbon-title">Zoom</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="gridBtn" class="ribbon-button">
                            <i class="fas fa-th"></i>
                            <span>Grid</span>
                        </button>
                        <button id="rulerBtn" class="ribbon-button">
                            <i class="fas fa-ruler-combined"></i>
                            <span>Guides</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Show</div>
                </div>
                
                <div class="ribbon-group">
                    <div class="ribbon-buttons">
                        <button id="toggleAIBtn" class="ribbon-button">
                            <i class="fas fa-robot"></i>
                            <span>AI Assistant</span>
                        </button>
                    </div>
                    <div class="ribbon-title">Extensions</div>
                </div>
            </div>

            <!-- AI Assistant Ribbon -->
            <div id="ai-assist-ribbon" class="ribbon-content">
                <div class="ai-tools-container">
                    <div class="ai-tools-section">
                        <h3 class="ai-tools-header">Content Creation</h3>
                        <button id="aiGenerateSlideBtn" class="ai-tool-btn">
                            <i class="fas fa-magic ai-tool-icon"></i>
                            <div class="ai-tool-text">
                                <span class="ai-tool-title">Generate Slide</span>
                                <span class="ai-tool-desc">Create a new slide based on your description</span>
                            </div>
                        </button>
                        <button id="aiGenerateTemplateBtn" class="ai-tool-btn">
                            <i class="fas fa-clipboard-list ai-tool-icon"></i>
                            <div class="ai-tool-text">
                                <span class="ai-tool-title">Complete Presentation</span>
                                <span class="ai-tool-desc">Create a full presentation template</span>
                            </div>
                        </button>
                        <button id="aiTransformTextBtn" class="ai-tool-btn">
                            <i class="fas fa-font ai-tool-icon"></i>
                            <div class="ai-tool-text">
                                <span class="ai-tool-title">Enhance Text</span>
                                <span class="ai-tool-desc">Improve selected text content</span>
                            </div>
                        </button>
                    </div>
                    
                    <div class="ai-tools-section">
                        <h3 class="ai-tools-header">Design Assistance</h3>
                        <button id="aiImproveLayoutBtn" class="ai-tool-btn">
                            <i class="fas fa-th-large ai-tool-icon"></i>
                            <div class="ai-tool-text">
                                <span class="ai-tool-title">Improve Layout</span>
                                <span class="ai-tool-desc">Enhance current slide layout</span>
                            </div>
                        </button>
                        <button id="aiSuggestDesignBtn" class="ai-tool-btn">
                            <i class="fas fa-paint-brush ai-tool-icon"></i>
                            <div class="ai-tool-text">
                                <span class="ai-tool-title">Suggest Design</span>
                                <span class="ai-tool-desc">Get theme & color recommendations</span>
                            </div>
                        </button>
                        <button id="aiSuggestImagesBtn" class="ai-tool-btn">
                            <i class="fas fa-images ai-tool-icon"></i>
                            <div class="ai-tool-text">
                                <span class="ai-tool-title">Suggest Images</span>
                                <span class="ai-tool-desc">Find relevant images for current slide</span>
                            </div>
                        </button>
                    </div>
                    
                    <div class="ai-tools-section">
                        <h3 class="ai-tools-header">Analysis & Feedback</h3>
                        <button id="aiAnalyzeSlideBtn" class="ai-tool-btn">
                            <i class="fas fa-chart-pie ai-tool-icon"></i>
                            <div class="ai-tool-text">
                                <span class="ai-tool-title">Analyze Current Slide</span>
                                <span class="ai-tool-desc">Get feedback on slide effectiveness</span>
                            </div>
                        </button>
                        <button id="aiAnalyzePresentationBtn" class="ai-tool-btn">
                            <i class="fas fa-search ai-tool-icon"></i>
                            <div class="ai-tool-text">
                                <span class="ai-tool-title">Analyze Full Presentation</span>
                                <span class="ai-tool-desc">Check structure and flow of presentation</span>
                            </div>
                        </button>
                        <button id="aiGenerateNotesBtn" class="ai-tool-btn">
                            <i class="fas fa-comment-alt ai-tool-icon"></i>
                            <div class="ai-tool-text">
                                <span class="ai-tool-title">Generate Speaker Notes</span>
                                <span class="ai-tool-desc">Create notes to help with presentation</span>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 메인 작업 영역 -->
        <div class="main-content">
            <!-- 슬라이드 목록 패널 -->
            <div class="slides-panel">
                <div class="slides-header">
                    <h3>슬라이드</h3>
                    <div class="slide-controls">
                        <button id="addSlideBtn" title="슬라이드 추가">
                            <i class="fas fa-plus"></i>
                        </button>
                        <button id="duplicateSlideBtn2" title="슬라이드 복제">
                            <i class="fas fa-copy"></i>
                        </button>
                        <button id="deleteSlideBtn2" title="슬라이드 삭제">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <!-- 슬라이드 목록 -->
                <div id="slideList" class="slide-list"></div>
            </div>
            
            <!-- 슬라이드 편집 영역 -->
            <div class="editor-panel">
                <div class="editor-toolbar">
                    <div class="toolbar-left">
                        <button id="undoBtn" title="실행 취소">
                            <i class="fas fa-undo"></i>
                        </button>
                        <button id="redoBtn" title="다시 실행">
                            <i class="fas fa-redo"></i>
                        </button>
                        <span class="toolbar-separator"></span>
                        <select id="slideLayoutSelect">
                            <option value="blank">빈 슬라이드</option>
                            <option value="title">제목 슬라이드</option>
                            <option value="title-content">제목 및 내용</option>
                            <option value="two-column">두 열 레이아웃</option>
                        </select>
                    </div>
                    <div class="toolbar-right">
                        <button id="exportBtn" title="내보내기">
                            <i class="fas fa-download"></i>
                            <span>내보내기</span>
                        </button>
                    </div>
                </div>
                
                <!-- 슬라이드 편집 영역 -->
                <div class="slide-editor independent-scroll">
                    <div id="currentSlide" class="slide-canvas">
                        <!-- Slide elements will be rendered here -->
                    </div>
                </div>
                
                <!-- 발표자 노트 패널 추가 -->
                <div class="presenter-notes-panel">
                    <div class="presenter-notes-header">
                        <h3>발표자 노트</h3>
                        <button id="toggleNotesBtn" class="toggle-btn">
                            <i class="fas fa-chevron-up"></i>
                        </button>
                    </div>
                    <div class="presenter-notes-content">
                        <textarea id="slideNotes" placeholder="이 슬라이드에 대한 발표자 노트를 작성하세요"></textarea>
                    </div>
                </div>
            </div>
            
            <!-- AI 패널 -->
            <div class="deep-seek-panel">
                <div class="deep-seek-header">
                    <h3>AI 어시스턴트</h3>
                    <button id="toggleAIPanelBtn" class="toggle-btn">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <div class="deep-seek-content">
                    <div class="ai-conversation">
                        <!-- AI 대화 내용이 여기에 표시됩니다 -->
                        <div class="ai-message assistant">
                            안녕하세요! 프레젠테이션 준비를 도와드릴 AI 어시스턴트입니다. 어떤 도움이 필요하신가요?
                        </div>
                    </div>
                </div>
                <div class="ai-input">
                    <textarea id="ai-prompt-input" placeholder="AI에게 질문하거나 작업을 요청하세요..."></textarea>
                    <button id="ai-submit">전송</button>
                </div>
            </div>
            
            <!-- 오른쪽 속성 패널 -->
            <div class="properties-panel">
                <div class="panel-header">
                    <h3>속성</h3>
                    <button id="closePropertiesBtn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="panel-tabs">
                    <button class="panel-tab active" data-panel="style">스타일</button>
                    <button class="panel-tab" data-panel="text">텍스트</button>
                    <button class="panel-tab" data-panel="arrange">정렬</button>
                    <button class="panel-tab" data-panel="animation">애니메이션</button>
                </div>
                
                <!-- 스타일 패널 -->
                <div class="panel-content active" id="style-panel">
                    <div class="panel-section">
                        <h4>색상 및 채우기</h4>
                        <div class="color-picker-group">
                            <label>배경색</label>
                            <input type="color" id="elementBgColor">
                        </div>
                        <div class="color-picker-group">
                            <label>테두리 색상</label>
                            <input type="color" id="elementBorderColor">
                        </div>
                        <div class="slider-group">
                            <label>투명도 <span id="opacityValue">100%</span></label>
                            <input type="range" id="elementOpacity" min="0" max="100" value="100">
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>테두리</h4>
                        <div class="input-group">
                            <label>두께</label>
                            <input type="number" id="borderWidth" min="0" max="20" value="1">
                        </div>
                        <div class="select-group">
                            <label>스타일</label>
                            <select id="borderStyle">
                                <option value="solid">실선</option>
                                <option value="dashed">파선</option>
                                <option value="dotted">점선</option>
                                <option value="double">이중선</option>
                                <option value="none">없음</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>효과</h4>
                        <div class="select-group">
                            <label>그림자</label>
                            <select id="shadowStyle">
                                <option value="none">없음</option>
                                <option value="light">약함</option>
                                <option value="medium">중간</option>
                                <option value="strong">강함</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- 텍스트 패널 -->
                <div class="panel-content" id="text-panel">
                    <div class="panel-section">
                        <h4>글꼴</h4>
                        <div class="select-group">
                            <label>글꼴</label>
                            <select id="textFontFamily">
                                <option value="Pretendard">Pretendard</option>
                                <option value="Arial">Arial</option>
                                <option value="Helvetica">Helvetica</option>
                                <option value="Times New Roman">Times New Roman</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>크기</label>
                            <input type="number" id="textFontSize" min="8" max="96" value="16">
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>스타일</h4>
                        <div class="button-group">
                            <button id="textBoldBtn" class="format-btn">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button id="textItalicBtn" class="format-btn">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button id="textUnderlineBtn" class="format-btn">
                                <i class="fas fa-underline"></i>
                            </button>
                        </div>
                        <div class="color-picker-group">
                            <label>텍스트 색상</label>
                            <input type="color" id="textColor">
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>정렬</h4>
                        <div class="button-group">
                            <button id="textAlignLeftBtn" class="format-btn">
                                <i class="fas fa-align-left"></i>
                            </button>
                            <button id="textAlignCenterBtn" class="format-btn">
                                <i class="fas fa-align-center"></i>
                            </button>
                            <button id="textAlignRightBtn" class="format-btn">
                                <i class="fas fa-align-right"></i>
                            </button>
                            <button id="textAlignJustifyBtn" class="format-btn">
                                <i class="fas fa-align-justify"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 정렬 패널 -->
                <div class="panel-content" id="arrange-panel">
                    <div class="panel-section">
                        <h4>위치</h4>
                        <div class="position-controls">
                            <div class="input-group">
                                <label>X</label>
                                <input type="number" id="elementX" step="1">
                            </div>
                            <div class="input-group">
                                <label>Y</label>
                                <input type="number" id="elementY" step="1">
                            </div>
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>크기</h4>
                        <div class="size-controls">
                            <div class="input-group">
                                <label>너비</label>
                                <input type="number" id="elementWidth" min="5" step="1">
                            </div>
                            <div class="input-group">
                                <label>높이</label>
                                <input type="number" id="elementHeight" min="5" step="1">
                            </div>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="lockAspectRatio">
                            <label for="lockAspectRatio">비율 고정</label>
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>회전</h4>
                        <div class="slider-group">
                            <label>각도 <span id="rotationValue">0°</span></label>
                            <input type="range" id="elementRotation" min="0" max="359" value="0">
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>기울이기</h4>
                        <div class="slider-group">
                            <label>X축 <span id="skewXValue">0°</span></label>
                            <input type="range" id="elementSkewX" min="-45" max="45" value="0">
                        </div>
                        <div class="slider-group">
                            <label>Y축 <span id="skewYValue">0°</span></label>
                            <input type="range" id="elementSkewY" min="-45" max="45" value="0">
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>순서</h4>
                        <div class="button-group">
                            <button id="bringToFrontBtn">맨 앞으로</button>
                            <button id="sendToBackBtn">맨 뒤로</button>
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>AI 분석</h4>
                        <div class="button-group">
                            <button id="analyzeElementBtn" class="btn-primary">
                                <i class="fas fa-magic"></i> 요소 분석 및 개선
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 애니메이션 패널 -->
                <div class="panel-content" id="animation-panel">
                    <div class="panel-section">
                        <h4>애니메이션</h4>
                        <div class="select-group">
                            <label>유형</label>
                            <select id="animationType">
                                <option value="none">없음</option>
                                <option value="fade">페이드</option>
                                <option value="slide">슬라이드</option>
                                <option value="zoom">확대/축소</option>
                                <option value="flip">뒤집기</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>시간</h4>
                        <div class="input-group">
                            <label>지속 시간 (초)</label>
                            <input type="number" id="animationDuration" min="0.1" max="10" step="0.1" value="1">
                        </div>
                        <div class="input-group">
                            <label>지연 시간 (초)</label>
                            <input type="number" id="animationDelay" min="0" max="10" step="0.1" value="0">
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>미리보기</h4>
                        <button id="previewAnimationBtn">재생</button>
                    </div>
                </div>
                
                <!-- AI 확장 패널 -->
                <div class="panel-content" id="ai-panel" style="display: none;">
                    <div class="panel-section">
                        <h4>AI 도구</h4>
                        <div class="button-group">
                            <button id="analyzeBtn">
                                <i class="fas fa-magic"></i>
                                <span>콘텐츠 분석</span>
                            </button>
                            <button id="generateImageBtn">
                                <i class="fas fa-image"></i>
                                <span>이미지 생성</span>
                            </button>
                            <button id="improveDesignBtn">
                                <i class="fas fa-paint-brush"></i>
                                <span>디자인 개선</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h4>AI 제안</h4>
                        <div id="aiSuggestions" class="ai-suggestions"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 상태 표시줄 -->
        <div class="status-bar">
            <div class="status-left">
                <span id="slideInfo">슬라이드 1/1</span>
            </div>
            <div class="status-right">
                <span id="zoomInfo">100%</span>
            </div>
        </div>
    </div>
    
    <!-- 모달 대화상자 -->
    <!-- 도형 선택 모달 -->
    <div id="shapeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>도형 선택</h3>
                <button class="close-btn">&times;</button>
            </div>
            
            <div class="shape-category">기본 도형</div>
            <div class="shape-grid">
                <div class="shape-item" data-shape="rectangle">
                    <div class="shape-preview rectangle"></div>
                    <span>사각형</span>
                </div>
                <div class="shape-item" data-shape="circle">
                    <div class="shape-preview circle"></div>
                    <span>원</span>
                </div>
                <div class="shape-item" data-shape="triangle">
                    <div class="shape-preview triangle"></div>
                    <span>삼각형</span>
                </div>
                <div class="shape-item" data-shape="diamond">
                    <div class="shape-preview diamond"></div>
                    <span>다이아몬드</span>
                </div>
                <div class="shape-item" data-shape="parallelogram">
                    <div class="shape-preview parallelogram"></div>
                    <span>평행사변형</span>
                </div>
                <div class="shape-item" data-shape="trapezoid">
                    <div class="shape-preview trapezoid"></div>
                    <span>사다리꼴</span>
                </div>
            </div>
            
            <div class="shape-category">다각형</div>
            <div class="shape-grid">
                <div class="shape-item" data-shape="pentagon">
                    <div class="shape-preview pentagon"></div>
                    <span>오각형</span>
                </div>
                <div class="shape-item" data-shape="hexagon">
                    <div class="shape-preview hexagon"></div>
                    <span>육각형</span>
                </div>
                <div class="shape-item" data-shape="star">
                    <div class="shape-preview star"></div>
                    <span>별</span>
                </div>
                <div class="shape-item" data-shape="cross">
                    <div class="shape-preview cross"></div>
                    <span>십자가</span>
                </div>
            </div>
            
            <div class="shape-category">화살표 및 말풍선</div>
            <div class="shape-grid">
                <div class="shape-item" data-shape="arrow">
                    <div class="shape-preview arrow"></div>
                    <span>화살표</span>
                </div>
                <div class="shape-item" data-shape="double-arrow">
                    <div class="shape-preview double-arrow"></div>
                    <span>양방향 화살표</span>
                </div>
                <div class="shape-item" data-shape="callout">
                    <div class="shape-preview callout"></div>
                    <span>말풍선</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 이미지 업로드 모달 -->
    <div id="imageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>이미지 추가</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="upload-area">
                    <p>이미지 파일을 드래그하거나 클릭하여 업로드하세요</p>
                    <input type="file" id="imageUploadInput" accept="image/*">
                    <button id="uploadImageBtn">파일 선택</button>
                </div>
                <div class="image-preview-container">
                    <img id="imagePreview" src="" alt="">
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelImageBtn" class="btn-secondary">취소</button>
                <button id="addImageToSlideBtn" class="btn-primary">슬라이드에 추가</button>
            </div>
        </div>
    </div>
    
    <!-- 내보내기 모달 -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>프레젠테이션 내보내기</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="export-options">
                    <div class="option-group">
                        <label>형식</label>
                        <select id="exportFormat">
                            <option value="pptx">PowerPoint (PPTX)</option>
                            <option value="pdf">PDF</option>
                            <option value="png">이미지 (PNG)</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <label>품질</label>
                        <select id="exportQuality">
                            <option value="high">높음</option>
                            <option value="medium">중간</option>
                            <option value="low">낮음</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelExportBtn" class="btn-secondary">취소</button>
                <button id="confirmExportBtn" class="btn-primary">내보내기</button>
            </div>
        </div>
    </div>
    
    <!-- 발표자 모드 모달 추가 -->
    <div id="presenterModal" class="modal">
        <div class="presenter-modal-content">
            <div class="presenter-header">
                <h3>발표자 모드</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="presenter-body">
                <div class="presenter-main-slide">
                    <div id="presenterCurrentSlide" class="presenter-slide"></div>
                    <div class="presenter-controls">
                        <button id="prevSlideBtn"><i class="fas fa-arrow-left"></i></button>
                        <span id="slideCounter">1/10</span>
                        <button id="nextSlideBtn"><i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
                <div class="presenter-sidebar">
                    <div class="presenter-next-slide">
                        <h4>다음 슬라이드</h4>
                        <div id="presenterNextSlide" class="presenter-preview"></div>
                    </div>
                    <div class="presenter-notes">
                        <h4>발표자 노트</h4>
                        <div id="presenterNotes" class="notes-content"></div>
                    </div>
                    <div class="presenter-timer">
                        <h4>발표 시간</h4>
                        <div class="timer-display">
                            <span id="presenterTimer">00:00:00</span>
                            <button id="startTimerBtn" class="timer-btn">
                                <i class="fas fa-play"></i>
                            </button>
                            <button id="resetTimerBtn" class="timer-btn">
                                <i class="fas fa-redo"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 디버그 정보 -->
    <div id="debug-info" style="display: none;"></div>
    <button id="show-debug" style="display: none;">Debug</button>
    
    <!-- 스크립트 -->
    <!-- Chart.js 필수 스크립트 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- 기본 JavaScript -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>